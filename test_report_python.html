<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Pruebas API CRM</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #333; border-bottom: 3px solid #007bff; padding-bottom: 10px; }
        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
        .stat { padding: 15px; border-radius: 6px; text-align: center; }
        .stat.total { background: #e3f2fd; }
        .stat.passed { background: #c8e6c9; }
        .stat.failed { background: #ffcdd2; }
        .stat.rate { background: #fff9c4; }
        .stat-value { font-size: 32px; font-weight: bold; }
        .stat-label { font-size: 14px; color: #666; margin-top: 5px; }
        .test { border: 1px solid #ddd; margin: 15px 0; border-radius: 6px; overflow: hidden; }
        .test-header { padding: 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .test-header:hover { background: #e9ecef; }
        .test-header.passed { border-left: 4px solid #4caf50; }
        .test-header.failed { border-left: 4px solid #f44336; }
        .test-body { padding: 15px; display: none; background: #fafafa; }
        .test-body.show { display: block; }
        .badge { padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        .badge.pass { background: #4caf50; color: white; }
        .badge.fail { background: #f44336; color: white; }
        .section { margin: 15px 0; }
        .section-title { font-weight: bold; color: #555; margin-bottom: 8px; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .json { background: #263238; color: #aed581; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
    <script>
        function toggleTest(id) {
            const body = document.getElementById('test-body-' + id);
            body.classList.toggle('show');
        }
    </script>
</head>
<body>
    <div class="container">
        <h1>Reporte de Pruebas API CRM</h1>
        <p>Generado: 2025-11-30 13:29:21</p>
        
        <div class="summary">
            <div class="stat total">
                <div class="stat-value">9</div>
                <div class="stat-label">Total de Pruebas</div>
            </div>
            <div class="stat passed">
                <div class="stat-value">9</div>
                <div class="stat-label">Exitosas</div>
            </div>
            <div class="stat failed">
                <div class="stat-value">0</div>
                <div class="stat-label">Fallidas</div>
            </div>
            <div class="stat rate">
                <div class="stat-value">100.0%</div>
                <div class="stat-label">Tasa de Exito</div>
            </div>
        </div>
        
        <h2>Detalle de Pruebas</h2>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(0)">
                <div>
                    <strong>Test GET Prospectos</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que el endpoint GET /api/Prospectos devuelve la lista completa de prospectos almacenados en la base de datos.</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-0" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT "Id", "CodigoProspecto", "NombreEmpresa", "EstadoProspecto" FROM "Prospectos" ORDER BY "Id"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "Id": 1,
    "CodigoProspecto": "PROS-2024-001",
    "NombreEmpresa": "Tecnolog\u00eda Avanzada SA",
    "EstadoProspecto": "Nuevo"
  },
  {
    "Id": 2,
    "CodigoProspecto": "PROS-2024-002",
    "NombreEmpresa": "Soluciones Empresariales MX",
    "EstadoProspecto": "Nuevo"
  },
  {
    "Id": 3,
    "CodigoProspecto": "PROS-2024-003",
    "NombreEmpresa": "Grupo Industrial del Sureste",
    "EstadoProspecto": "Nuevo"
  },
  {
    "Id": 4,
    "CodigoProspecto": "PROS-2025-001",
    "NombreEmpresa": "Test Company API",
    "EstadoProspecto": "Nuevo"
  },
  {
    "Id": 5,
    "CodigoProspecto": "PROS-2025-002",
    "NombreEmpresa": "Test Company Enhanced",
    "EstadoProspecto": "Nuevo"
  },
  {
    "Id": 6,
    "CodigoProspecto": "PROS-2025-003",
    "NombreEmpresa": "Test Visual Script",
    "EstadoProspecto": "Nuevo"
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Prospectos</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[{"id":6,"codigoProspecto":"PROS-2025-003","nombreEmpresa":"Test Visual Script","nombreContacto":"Pedro","apellidoContacto":"Visual","email":"pedro.visual@test.com","telefono":"+52-55-7777-6666","pais":"México","fuenteId":3,"estadoProspecto":"Nuevo","prioridad":"Alta","valorEstimado":100000.00,"probabilidadCierre":80,"vendedorAsignadoId":1,"sucursalId":3,"fechaCreacion":"2025-11-28T21:33:24.631812Z","fechaActualizacion":"2025-11-28T21:33:24.631812Z","fuente":{"id":3,"nombreFuente":"Referido Clie</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_prospectos FROM "Prospectos"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_prospectos": 6
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200 and len(json) > 0</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(1)">
                <div>
                    <strong>Test GET Prospecto por ID</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se puede obtener un prospecto especifico por su ID</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-1" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT "Id", "CodigoProspecto", "NombreEmpresa" FROM "Prospectos" WHERE "Id" = 1</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "Id": 1,
    "CodigoProspecto": "PROS-2024-001",
    "NombreEmpresa": "Tecnolog\u00eda Avanzada SA"
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Prospectos/1</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">{"id":1,"codigoProspecto":"PROS-2024-001","nombreEmpresa":"Tecnología Avanzada SA","nombreContacto":"Carlos","apellidoContacto":"Ramírez","email":"cramirez@tecavanzada.com","telefono":"+52-81-5555-1234","pais":"México","fuenteId":1,"estadoProspecto":"Nuevo","prioridad":"Media","valorEstimado":150000.00,"probabilidadCierre":0,"vendedorAsignadoId":1,"sucursalId":1,"fechaCreacion":"2025-11-27T20:10:35.206576Z","fechaActualizacion":"2025-11-27T20:10:35.206576Z","fuente":{"id":1,"nombreFuente":"Expo </div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT "FechaActualizacion" FROM "Prospectos" WHERE "Id" = 1</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "FechaActualizacion": "2025-11-27 15:10:35.206576-05:00"
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200 and json['id'] == 1 and json['codigoProspecto'] is not None</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(2)">
                <div>
                    <strong>Test GET Fuentes de Prospectos</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se obtienen todas las fuentes de prospectos disponibles</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-2" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT "Id", "NombreFuente" FROM "FuentesProspecto" ORDER BY "Id"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "Id": 1,
    "NombreFuente": "Expo Industrial 2024"
  },
  {
    "Id": 2,
    "NombreFuente": "Campa\u00f1a Digital Q1"
  },
  {
    "Id": 3,
    "NombreFuente": "Referido Cliente"
  },
  {
    "Id": 4,
    "NombreFuente": "Sitio Web"
  },
  {
    "Id": 5,
    "NombreFuente": "Llamada Fr\u00eda"
  },
  {
    "Id": 6,
    "NombreFuente": "LinkedIn"
  },
  {
    "Id": 7,
    "NombreFuente": "Evento Networking"
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Prospectos/fuentes</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[{"id":1,"nombreFuente":"Expo Industrial 2024","descripcion":"Exposición industrial anual","tipoFuente":"Expo","fechaCreacion":"2025-11-27T20:10:35.206553Z","prospectos":[]},{"id":2,"nombreFuente":"Campaña Digital Q1","descripcion":"Campaña de marketing digital primer trimestre","tipoFuente":"Campaña","fechaCreacion":"2025-11-27T20:10:35.206553Z","prospectos":[]},{"id":3,"nombreFuente":"Referido Cliente","descripcion":"Referencia de cliente existente","tipoFuente":"Referido","fechaCreacion":"202</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_fuentes FROM "FuentesProspecto"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_fuentes": 7
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200 and len(json) == post_sql[0]['total_fuentes']</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(3)">
                <div>
                    <strong>Test GET Categorias de Clientes</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se obtienen todas las categorias de clientes con sus descuentos</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-3" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT "Id", "NombreCategoria", "PorcentajeDescuento" FROM "CategoriasCliente" ORDER BY "PorcentajeDescuento" DESC</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "Id": 1,
    "NombreCategoria": "Premium",
    "PorcentajeDescuento": "20.00"
  },
  {
    "Id": 2,
    "NombreCategoria": "Corporativo",
    "PorcentajeDescuento": "15.00"
  },
  {
    "Id": 3,
    "NombreCategoria": "Regular",
    "PorcentajeDescuento": "10.00"
  },
  {
    "Id": 4,
    "NombreCategoria": "Nuevo",
    "PorcentajeDescuento": "5.00"
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Clientes/categorias</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[{"id":1,"nombreCategoria":"Premium","porcentajeDescuento":20.00,"descripcion":"Clientes premium con descuento máximo","fechaCreacion":"2025-11-27T20:10:35.206546Z","clientes":[]},{"id":2,"nombreCategoria":"Corporativo","porcentajeDescuento":15.00,"descripcion":"Clientes corporativos con descuento medio","fechaCreacion":"2025-11-27T20:10:35.206547Z","clientes":[]},{"id":3,"nombreCategoria":"Regular","porcentajeDescuento":10.00,"descripcion":"Clientes regulares con descuento estándar","fechaCreac</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_categorias FROM "CategoriasCliente"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_categorias": 4
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200 and len(json) == 4 and json[0]['porcentajeDescuento'] == 20</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(4)">
                <div>
                    <strong>Test POST Crear Prospecto</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se puede crear un nuevo prospecto correctamente</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-4" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_antes FROM "Prospectos"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_antes": 6
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>POST http://localhost:5000/api/Prospectos</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 201</pre>
                    <div class="json">{"id":7,"codigoProspecto":"PROS-2025-004","nombreEmpresa":"Test Python Runner","nombreContacto":"Juan","apellidoContacto":"Prueba","email":"juan.prueba@test.com","telefono":"+52-55-1234-5678","pais":"México","fuenteId":1,"estadoProspecto":"Nuevo","prioridad":"Alta","valorEstimado":50000,"probabilidadCierre":70,"vendedorAsignadoId":1,"sucursalId":1,"fechaCreacion":"2025-11-30T18:29:21.6272214Z","fechaActualizacion":"2025-11-30T18:29:21.6272216Z","fuente":{"id":1,"nombreFuente":"Expo Industrial 20</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_despues, MAX("Id") as ultimo_id FROM "Prospectos"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_despues": 7,
    "ultimo_id": 7
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 201 and post_sql[0]['total_despues'] == pre_sql[0]['total_antes'] + 1</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(5)">
                <div>
                    <strong>Test GET Embudo de Ventas</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se obtienen las estadisticas del embudo de ventas</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-5" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT "EstadoProspecto", COUNT(*) as total FROM "Prospectos" GROUP BY "EstadoProspecto"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "EstadoProspecto": "Nuevo",
    "total": 7
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Prospectos/embudo-ventas</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[{"estado":"Nuevo","cantidad":7,"valorTotal":730000.00}]</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(DISTINCT "EstadoProspecto") as estados_distintos FROM "Prospectos"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "estados_distintos": 1
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200 and len(json) > 0</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(6)">
                <div>
                    <strong>Test GET Clientes</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se obtiene la lista de clientes (puede estar vacia)</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-6" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_clientes FROM "Clientes"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_clientes": 0
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Clientes</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[]</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_clientes FROM "Clientes"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_clientes": 0
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200 and len(json) == pre_sql[0]['total_clientes']</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(7)">
                <div>
                    <strong>Test GET Estadisticas Clientes por Categoria</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se obtienen estadisticas de clientes agrupados por categoria</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-7" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_categorias FROM "CategoriasCliente"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_categorias": 4
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Clientes/estadisticas-categorias</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[]</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_categorias FROM "CategoriasCliente"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_categorias": 4
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

        <div class="test">
            <div class="test-header passed" onclick="toggleTest(8)">
                <div>
                    <strong>Test GET Estadisticas Clientes por Sucursal</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 4px;">Verificar que se obtienen estadisticas de clientes agrupados por sucursal</div>
                </div>
                <span class="badge pass">PASS</span>
            </div>
            <div id="test-body-8" class="test-body">

                <div class="section">
                    <div class="section-title">Precondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_sucursales FROM "Sucursales"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_sucursales": 3
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">HTTP Request:</div>
                    <pre>GET http://localhost:5000/api/Clientes/estadisticas-sucursales</pre>
                    <div class="section-title">HTTP Response:</div>
                    <pre>Status: 200</pre>
                    <div class="json">[]</div>
                </div>

                <div class="section">
                    <div class="section-title">Postcondicion SQL:</div>
                    <pre>SELECT COUNT(*) as total_sucursales FROM "Sucursales"</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>[
  {
    "total_sucursales": 3
  }
]</pre>
                </div>

                <div class="section">
                    <div class="section-title">Asercion:</div>
                    <pre>status_code == 200</pre>
                    <div class="section-title">Resultado:</div>
                    <pre>Asercion pasada</pre>
                </div>

            </div>
        </div>

    </div>
</body>
</html>
